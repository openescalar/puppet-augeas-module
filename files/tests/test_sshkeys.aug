(*
vim: ts=2 sw=2 expandtab
*)
module Test_sshkeys =
  let conf ="# /root/.ssh/authorized_keys
# Other comment
1024 37 6647498593555771889039784216642018433439317303642300923511229490457217281403091384851574815417105493985161975736353770802614692722425665723934621677527752440607069872281111111111111111 root@mybox
ssh-dsa MrkTzGQ6L2SuQh0WCxqtycLRdGa878/aRvwFxWEO+S4ZJ0iZ10ucHoBGaH464pWzuyqHUwa90bY24hnmejdsSVIUwSSx2Xb3rwvgdSRy7WvfxopPOVAAAAFQD1PhjwJQQIOKBqLPr4hvaB5wuz+QAAAIAWsLb47TDV/mMqfmm9O7zGFjToaeILu6q588/haLFLB8dsbQlsbxS86zsZr7Wo01nfElMm01PBMbSPg11111111111111111111111GfaZL0uk9EIJx2222222222222222D2JsNt6ooYJGfS30LEunJu6t8G9yqQ11111111111111111111111kloTtfvXbd1+sXsgAAAIB93/Y99rKtkWNvFIDhk4UeQZmfeob5au9iV2BtUX624kA9UtlEkbokOXZgs3jL0jKFWcowJojq8e6eZuptdCBI8q+kThIM09Yp00AI/cU9cSRHbnnuR6O8kOFT4+g+gfCChcpJlbG4XRNaOasB1wUNQ9UDdKpoijz9UIeufeIaRA== root@mybox2
ssh-rsa NTnRqocnEglLXV6QGD5pAQbIopjiiu7f792h2ztkyvxEoKwq6oYP3BgdbY3z1dyQ1AAAAFQDErpY1FCwIg5zbkYRfJo4MNmt4GQAAAIEAlHFM/obMjPdslfFbAVdgbmGmRJszKyHv5zfPmvNgFcgYVL+i8shRoePeb7KiAaw93kIUB2TBWsmy32e5gwgzBV8q4fpb2XV5koljGoXqo44I9rajDeZFuXBmAVGwY+i5pTNXlFiBAi2222222222TQoU222222222222222222HUk0sAAA111111111111111DpyGPIl36VtbEF0RuRxWWhFB0Wsj5CoU8szAdKwKOr6Xyxe0BGNH7QI9QpuNDi5tjcgCXBw+zkrdkQB6Act92w+V+lgLi7GsBjOSRgJV1ZT6HUqrjjmo+yXGINd0rUrqMnkZiVqptKvg+O9w==
"

  test Sshkeys.lns get conf =
    { "#comment" = "/root/.ssh/authorized_keys" } 
    { "#comment" = "Other comment" }
    { "1024 37" 
      { "keyv" = "145032662060286823078402181650037397427378464836966434477783506415560764729224620828331319973659850253291139062157444359712026647498593555771889039784216642018433439317303642300923511229490457217281403091384851574815417105493985161111111111111111111111111111111111111111111111111111111111111111" }
      { "keyv" = "root@mybox" }
    }
    { "ssh-dsa"
      { "keyv" = "O+S4ZJ0iZ10ucHoBGaH464pWzuyqHUwa90bY24hnmejdsSVIUwSSx2Xb3rwvgdSRy7WvfxopPOVAAAAFQD1PhjwJQQIOKBqLPr4hvaB5wuz+QAAAIAWsLb47TDV/mMqfmm9O7zGFjToaeILu6q588/haLFLB8dsbQlsbxS86zsZr7Wo01nfElMm01PBMbSPgGfaZL0uk9EIJxD2JsNt6ooYJGfS30LEunJu6t8G9yqQ8U7TWT80FJB//Igv+o8KvxHAxbABl3niaGkloTtfvXbd1+sXsgAAAIB93/Y99rKtkWNvFIDhk4UeQZmfeob5au9iV2BtUX624kA9UtlEkbokOXZgs3jL0jKFWcowJojq8e6eZuptdCBI8q+kThIM09Yp00AI/cU9cSRHbnnuR6O8kOFT4+g+gfCChcpJlbG4XRNaOasB1wUNQ9UDdKpoijz9UIeufeIaRA==" }
      { "keyv" = "root@mybox2" }
    }
    { "ssh-rsa"
      { "keyv" = "QDErpY1FCwIg5zbkYRfJo4MNmt4GQAAAIEAlHFM/obMjPdslfFbAVdgbmGmRJszKyHv5zfPmvNgFcgYVL+i8shRoePeb7KiAaw93kIUB2TBWsmy32e5gwgzBV8q4fpb2XV5koljGoXqo44I9rajDeZFuXBmAVGwY+i5pTNXlFiBAiTQoU/4jz2CJP8th2rYLU1dW5mQQWHUk0sAAAB/HRz8QlthPNXSMiUvnwAU8K5XU1DpyGPIl36VtbEF0RuRxWWhFB0Wsj5CoU8szAdKwKOr6Xyxe0BGNH7QI9QpuNDi5tjcgCXBw+zkrdkQB6Act92w+V+lgLi7GsBjOSRgJV1ZT6HUqrjjmo+yXGINd0rUrqMnkZiVqptKvg+O9w==" }
    }
